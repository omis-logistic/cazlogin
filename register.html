<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <title>Register - Cahaya Az Zahra Enterprise</title>
  <link rel="stylesheet" href="styles/main.css">
  <style>
    .registration-page {
      max-width: 500px;
      animation: fadeIn 0.3s ease-in;
    }

    .password-rules {
      font-size: 0.8em;
      color: var(--gold);
      margin: 5px 0 10px;
      opacity: 0.8;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @media (max-width: 480px) {
      .registration-page {
        padding: 15px;
      }
      
      input {
        padding: 12px;
        font-size: 16px;
      }
    }
  </style>
</head>
<body>
  <div class="container registration-page">
    <h1>New Registration</h1>
    
    <form id="registrationForm">
      <div class="input-group">
        <input type="tel" 
               id="regPhone" 
               placeholder="Phone (673/60 format)"
               pattern="^(673\d{7,}|60\d{9,})$" 
               required>
        <div class="error-message" id="phoneError"></div>
      </div>

      <div class="input-group">
        <input type="password" 
               id="regPassword" 
               placeholder="Create Password"
               pattern="^(?=.*[A-Z])(?=.*\d).{6,}$" 
               required>
        <div class="password-rules">6+ characters, 1 uppercase, 1 number</div>
        <div class="error-message" id="passError"></div>
      </div>

      <div class="input-group">
        <input type="password" 
               id="regConfirmPass" 
               placeholder="Confirm Password" 
               required>
        <div class="error-message" id="confirmPassError"></div>
      </div>

      <div class="input-group">
        <input type="email" 
               id="regEmail" 
               placeholder="Email Address" 
               required>
        <div class="error-message" id="emailError"></div>
      </div>

      <div class="input-group">
        <input type="email" 
               id="regConfirmEmail" 
               placeholder="Confirm Email" 
               required>
        <div class="error-message" id="confirmEmailError"></div>
      </div>

      <button type="button" id="registerBtn">Register</button>
      <button type="button" 
              class="secondary-btn" 
              onclick="safeRedirect('login.html')"
              style="margin-top: 10px;">
        Back to Login
      </button>
    </form>

    <div id="registrationStatus" class="status-message"></div>
  </div>

  <script src="scripts/app.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      detectViewMode();
      
      const registerBtn = document.getElementById('registerBtn');
      if (registerBtn) {
        registerBtn.addEventListener('click', handleRegistration);
      }

      // Real-time validation
      document.getElementById('regPhone')?.addEventListener('input', function() {
        document.getElementById('phoneError').textContent = 
          !validatePhone(this.value) ? 'Invalid phone format' : '';
      });

      document.getElementById('regPassword')?.addEventListener('input', function() {
        document.getElementById('passError').textContent = 
          !validatePassword(this.value) ? '6+ chars, 1 uppercase, 1 number' : '';
      });

      document.getElementById('regConfirmPass')?.addEventListener('input', function() {
        document.getElementById('confirmPassError').textContent = 
          this.value !== document.getElementById('regPassword').value ? 'Passwords mismatch' : '';
      });

      document.getElementById('regEmail')?.addEventListener('input', function() {
        document.getElementById('emailError').textContent = 
          !validateEmail(this.value) ? 'Invalid email format' : '';
      });

      document.getElementById('regConfirmEmail')?.addEventListener('input', function() {
        document.getElementById('confirmEmailError').textContent = 
          this.value !== document.getElementById('regEmail').value ? 'Emails mismatch' : '';
      });
    });
  </script>
</body>
</html>
